<!DOCTYPE html>
<html lang="ru" data-beasties-container="" class="dark" style="--tg-color-scheme: dark; --tg-theme-bg-color: #212121; --tg-theme-text-color: #ffffff; --tg-theme-hint-color: #aaaaaa; --tg-theme-link-color: #8774e1; --tg-theme-button-color: #8774e1; --tg-theme-button-text-color: #ffffff; --tg-theme-secondary-bg-color: #0f0f0f; --tg-theme-header-bg-color: #212121; --tg-theme-accent-text-color: #8774e1; --tg-theme-section-bg-color: #212121; --tg-theme-section-header-text-color: #aaaaaa; --tg-theme-subtitle-text-color: #aaaaaa; --tg-theme-destructive-text-color: #e53935; --tg-viewport-height: 461px; --tg-viewport-stable-height: 461px; --tg-safe-area-inset-top: 0px; --tg-safe-area-inset-bottom: 0px; --tg-safe-area-inset-left: 0px; --tg-safe-area-inset-right: 0px; --tg-content-safe-area-inset-top: 0px; --tg-content-safe-area-inset-bottom: 0px; --tg-content-safe-area-inset-left: 0px; --tg-content-safe-area-inset-right: 0px; --mouse-x: 406; --mouse-y: 451;">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="Cache-Control" content="no-cache">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>CitybusBotWebApp</title>
    <base href=".">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=0, viewport-fit=cover, shrink-to-fit=no">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    
    <!-- Font Awesome Styles -->
    <style type="text/css" id="fa-auto-css">
    /* Font Awesome styles from saved_resource.html */
    :root, :host {
      --fa-font-solid: normal 900 1em/1 "Font Awesome 6 Free";
      --fa-font-regular: normal 400 1em/1 "Font Awesome 6 Free";
      --fa-font-light: normal 300 1em/1 "Font Awesome 6 Pro";
      --fa-font-thin: normal 100 1em/1 "Font Awesome 6 Pro";
      --fa-font-duotone: normal 900 1em/1 "Font Awesome 6 Duotone";
      --fa-font-duotone-regular: normal 400 1em/1 "Font Awesome 6 Duotone";
      --fa-font-duotone-light: normal 300 1em/1 "Font Awesome 6 Duotone";
      --fa-font-duotone-thin: normal 100 1em/1 "Font Awesome 6 Duotone";
      --fa-font-brands: normal 400 1em/1 "Font Awesome 6 Brands";
      --fa-font-sharp-solid: normal 900 1em/1 "Font Awesome 6 Sharp";
      --fa-font-sharp-regular: normal 400 1em/1 "Font Awesome 6 Sharp";
      --fa-font-sharp-light: normal 300 1em/1 "Font Awesome 6 Sharp";
      --fa-font-sharp-thin: normal 100 1em/1 "Font Awesome 6 Sharp";
      --fa-font-sharp-duotone-solid: normal 900 1em/1 "Font Awesome 6 Sharp Duotone";
      --fa-font-sharp-duotone-regular: normal 400 1em/1 "Font Awesome 6 Sharp Duotone";
      --fa-font-sharp-duotone-light: normal 300 1em/1 "Font Awesome 6 Sharp Duotone";
      --fa-font-sharp-duotone-thin: normal 100 1em/1 "Font Awesome 6 Sharp Duotone";
    }

    svg:not(:root).svg-inline--fa, svg:not(:host).svg-inline--fa {
      overflow: visible;
      box-sizing: content-box;
    }

    .svg-inline--fa {
      display: var(--fa-display, inline-block);
      height: 1em;
      overflow: visible;
      vertical-align: -0.125em;
    }
    /* ... остальные Font Awesome стили ... */
    </style>

    <!-- Ant Design and Global Styles -->
    <style>
    * {
      scrollbar-width: thin;
      scrollbar-color: rgba(90, 90, 90, 0.3) transparent;
    }

    *::-webkit-scrollbar {
      width: 6px;
      height: 6px;
      background-color: transparent;
    }

    *::-webkit-scrollbar-thumb {
      border-radius: 6px;
      background-color: rgba(90, 90, 90, 0.3);
    }

    *::-webkit-scrollbar-corner {
      background-color: transparent;
    }

    html,body{width:100%;height:100%}*,*:before,*:after{box-sizing:border-box}html{font-family:sans-serif;line-height:1.15;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%;-ms-overflow-style:scrollbar;-webkit-tap-highlight-color:rgba(0,0,0,0)}@-ms-viewport{width:device-width}body{margin:0;color:#000000d9;font-size:16px;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,"Apple Color Emoji","Segoe UI Emoji",Segoe UI Symbol,"Noto Color Emoji";font-variant:tabular-nums;line-height:1.5715;background-color:#fff;font-feature-settings:"tnum"}html{--antd-wave-shadow-color:#E21A1A;--scroll-bar:0}.ant-row{display:flex;flex-flow:row wrap;min-width:0}.ant-row:before,.ant-row:after{display:flex}.ant-row-center{justify-content:center}.ant-row-middle{align-items:center}:root{--primary-color:#E21A1A;--font-size-base-number:16;--font-size-sm-number:15;--sat:env(safe-area-inset-top);--sar:env(safe-area-inset-right);--sab:env(safe-area-inset-bottom);--sal:env(safe-area-inset-left)}html{--tg-theme-button-color:#0066A1 !important}
    
    body{touch-action:pan-x,pan-y!important;-webkit-user-select:none;-ms-user-select:none;user-select:none}

    /* Custom styles from saved_resource.html */
    .inner-content{padding:24px;min-height:280px}
    nz-progress{display:flex;position:fixed;top:0;width:100%;z-index:99999}
    #main-button{position:fixed;bottom:calc(var(--sat) / 5);left:0;z-index:99999}
    #back-button{position:fixed;top:calc(var(--sab) + 10px);left:8px;z-index:99999;background-color:#272b3733;height:36px;border-radius:8px;box-shadow:none;border:none}
    
    :root{--dots-top: "0px"}
    #wrap{flex:1;display:flex;overflow:hidden}
    .watermark:after{background-image:url("./media/logo-circle-XE56EXFF.png");background-size:100px;width:100px;height:100px;overflow:hidden;content:"";position:absolute;top:calc(var(--mouse-y, 0) * 1px - 100px);left:calc(var(--mouse-x, 0) * 1px - 50px);opacity:0}
    .watermark:hover:before{opacity:0}
    .watermark:active:after,.watermark:hover:after{opacity:1}
    img{margin:auto;max-height:100%}
    .inner-content{padding:0!important}
    .slick-list{padding-top:2vh!important}
    .slick-dots-top{top:0!important}
    .slick-dots li.slick-active button{background-color:var(--primary-color)!important}
    .slick-dots li:not(.slick-active) button{background-color:var(--primary-color)!important}
    .list-p{padding-top:2px;padding-bottom:2px}
    .ant-list-item-meta-content{container-type:inline-size}
    .scale__container--js{text-align:center}
    .scale--js{display:inline-block;transform-origin:50% 0;-webkit-font-smoothing:antialiased;transform:translateZ(0)}

    /* Ant Design Tabs Styles */
    .ant-tabs {box-sizing: border-box;margin: 0;padding: 0;color: rgba(0, 0, 0, 0.85);font-size: 14px;font-variant: tabular-nums;line-height: 1.5715;list-style: none;font-feature-settings: 'tnum';display: flex;}
    .ant-tabs-top {flex-direction: column;}
    .ant-tabs-centered .ant-tabs-nav {text-align: center;}
    .ant-tabs-nav {display: flex;position: relative;margin: 0;border-bottom: 1px solid #303030;outline: none;list-style: none;transition: background 0.3s;}
    .ant-tabs-nav-wrap {position: relative;display: flex;flex: auto;align-self: stretch;overflow: hidden;white-space: nowrap;}
    .ant-tabs-nav-list {position: relative;display: flex;transition: transform 0.3s;}
    .ant-tabs-tab {position: relative;display: inline-flex;align-items: center;padding: 12px 0;font-size: 14px;background: transparent;border: 0;outline: none;cursor: pointer;color: #aaaaaa;}
    .ant-tabs-tab-active {color: #8774e1;}
    .ant-tabs-tab-btn {outline: none;transition: all 0.3s;}
    .ant-tabs-ink-bar {position: absolute;background: #8774e1;pointer-events: none;}
    .ant-tabs-content-holder {flex: auto;min-width: 0;min-height: 0;}
    .ant-tabs-content {width: 100%;}
    .ant-tabs-tabpane {outline: none;}

    /* Ant Design List Styles */
    .ant-list {box-sizing: border-box;margin: 0;padding: 0;color: rgba(0, 0, 0, 0.85);font-size: 14px;list-style: none;position: relative;}
    .ant-list-split .ant-list-item {border-bottom: 1px solid #303030;}
    .ant-list-item {display: flex;align-items: center;justify-content: space-between;padding: 12px 0;color: rgba(0, 0, 0, 0.85);}
    .ant-list-item-meta {display: flex;flex: 1;align-items: flex-start;}
    .ant-list-item-meta-avatar {margin-right: 16px;}
    .ant-list-item-meta-content {flex: 1 0;}
    .ant-list-item-meta-title {margin-bottom: 4px;color: rgba(0, 0, 0, 0.85);font-size: 14px;line-height: 1.5715;}
    .ant-list-item-meta-description {color: #aaaaaa;font-size: 14px;line-height: 1.5715;}

    /* Dark theme adjustments */
    .dark {background: #212121; color: #ffffff;}
    .dark .ant-tabs-tab {color: #aaaaaa;}
    .dark .ant-tabs-tab-active {color: #8774e1;}
    .dark .ant-list-item {color: #ffffff;}
    .dark .ant-list-item-meta-title {color: #ffffff;}
    </style>
</head>

<body>
    <script>
        // for mobile devices
        document.addEventListener('touchstart', e => {
            if (e.touches.length > 1) {
                e.preventDefault()
            }
        }, {
            passive: false
        });

        // Telegram Web App initialization
        let tg = window.Telegram.WebApp;
        tg.expand();
        tg.enableClosingConfirmation();

        // Theme detection and setup
        (async function () {
            function setThemeClass(theme) {
                document.documentElement.className = theme;
            }

            var isTelegram = !!Telegram.WebApp.initData;

            if (isTelegram) {
                setThemeClass(Telegram.WebApp.colorScheme);
                Telegram.WebView.onEvent('theme_changed', () => setThemeClass(Telegram.WebApp.colorScheme));
                Telegram.WebApp.ready();
            }
        })();
    </script>

    <!-- Progress Bar -->
    <div class="ant-progress ant-progress-status-normal ant-progress-line ant-progress-default">
        <div class="ant-progress-outer">
            <div class="ant-progress-inner">
                <div class="ant-progress-bg" style="width: 0%; border-radius: 100px; background-color: rgb(226, 26, 26); height: 3px;"></div>
            </div>
        </div>
    </div>

    <!-- Main Layout -->
    <div class="ant-layout" style="min-height: 100vh;">
        <div class="inner-content ant-layout-content">
            <!-- Header with Timer -->
            <h2 style="text-align: center; padding-top: 1vh; color: #ffffff;">Действует: <span id="timer">3 сек.</span></h2>

            <!-- Tabs -->
            <div class="ant-tabs ant-tabs-centered ant-tabs-top ant-tabs-default">
                <div class="ant-tabs-nav">
                    <div class="ant-tabs-nav-wrap">
                        <div class="ant-tabs-nav-list" style="transform: translate(0px, 0px);">
                            <div class="ant-tabs-tab ant-tabs-tab-active">
                                <button type="button" role="tab" class="ant-tabs-tab-btn" id="ticket-tab-btn">
                                    <!-- Font Awesome Icon -->
                                    <svg class="svg-inline--fa fa-memo-circle-check fa-lg" style="display: inline-block; height: 1em; overflow: visible; vertical-align: -0.125em;" aria-hidden="true" focusable="false" data-prefix="far" data-icon="memo-circle-check" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512">
                                        <path fill="currentColor" d="M320 48H63.1C55.16 48 47.1 55.16 47.1 64V448C47.1 456.8 55.16 464 63.1 464H284.5C296.5 482.4 311.9 498.5 329.7 511.3C326.6 511.7 323.3 512 320 512H64C28.65 512 0 483.3 0 448V64C0 28.65 28.65 0 64 0H320C355.3 0 384 28.65 384 64V198.6C366.8 203.5 350.6 210.9 336 220.5V63.1C336 55.16 328.8 47.1 320 47.1L320 48zM95.1 152C95.1 138.7 106.7 128 119.1 128H263.1C277.3 128 287.1 138.7 287.1 152C287.1 165.3 277.3 176 263.1 176H119.1C106.7 176 95.1 165.3 95.1 152zM263.1 224C277.3 224 287.1 234.7 287.1 248C287.1 261.3 277.3 272 263.1 272H119.1C106.7 272 95.1 261.3 95.1 248C95.1 234.7 106.7 224 119.1 224H263.1zM167.1 320C181.3 320 191.1 330.7 191.1 344C191.1 357.3 181.3 368 167.1 368H119.1C106.7 368 95.1 357.3 95.1 344C95.1 330.7 106.7 320 119.1 320H167.1zM576 368C576 447.5 511.5 512 432 512C352.5 512 287.1 447.5 287.1 368C287.1 288.5 352.5 224 432 224C511.5 224 576 288.5 576 368zM476.7 324.7L416 385.4L387.3 356.7C381.1 350.4 370.9 350.4 364.7 356.7C358.4 362.9 358.4 373.1 364.7 379.3L404.7 419.3C410.9 425.6 421.1 425.6 427.3 419.3L499.3 347.3C505.6 341.1 505.6 330.9 499.3 324.7C493.1 318.4 482.9 318.4 476.7 324.7H476.7z"></path>
                                    </svg>
                                    &nbsp; <span style="font-size: large;" id="order-id">1 261 842 916</span>
                                </button>
                            </div>
                            <div class="ant-tabs-tab">
                                <button type="button" role="tab" class="ant-tabs-tab-btn" id="control-tab-btn">
                                    <!-- Font Awesome Icon -->
                                    <svg class="svg-inline--fa fa-user-pilot fa-lg" style="display: inline-block; height: 1em; overflow: visible; vertical-align: -0.125em;" aria-hidden="true" focusable="false" data-prefix="far" data-icon="user-pilot" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">
                                        <path fill="currentColor" d="M319.7 352.5L224 416l-95.7-63.49C57.05 355.2 0 413.4 0 485.3C0 500.1 11.94 512 26.66 512H421.3C436.1 512 448 500.1 448 485.3C448 413.4 390.1 355.2 319.7 352.5zM50.69 464c8.043-31.21 33.37-55.43 65.56-61.89L209.5 464H50.69zM238.5 464l93.28-61.89c32.19 6.461 57.52 30.68 65.56 61.89H238.5zM78.54 102.4v44.04C119.1 164.9 169.4 176 224 176s104.9-11.08 145.5-29.55V102.4l21.96-22.3c4.564-4.635 7.129-10.93 7.129-17.48c0-11.35-7.602-21.24-18.44-23.99l-148.3-37.67c-5.096-1.295-10.43-1.295-15.52 0l-148.3 37.67C57.06 41.39 49.46 51.28 49.46 62.62c0 6.555 2.564 12.85 7.129 17.48L78.54 102.4zM161.7 72.85c3.969-7.875 13.56-11.09 21.47-7.156L224 86.13l40.84-20.44c7.938-3.969 17.5-.7505 21.47 7.156c3.938 7.906 .75 17.5-7.156 21.47l-48 23.1C228.9 119.4 226.4 120 224 120S219.1 119.4 216.8 118.3l-48-23.1C160.9 90.35 157.8 80.75 161.7 72.85zM224 272c-41.23 0-74.9-31.51-79.15-71.64C128.1 197.1 112 192.8 96.45 187.5C96.4 189.1 96 190.5 96 192c0 70.69 57.31 128 127.1 128s127.1-57.31 127.1-128c0-1.525-.358-2.941-.4108-4.453C336 192.8 319.9 197.1 303.2 200.4C298.9 240.5 265.2 272 224 272z"></path>
                                    </svg>
                                    &nbsp; <span style="font-size: large;">Контроль</span>
                                </button>
                            </div>
                            <div class="ant-tabs-ink-bar ant-tabs-ink-bar-animated" style="left: 0px; width: 155px;"></div>
                        </div>
                    </div>
                </div>

                <div class="ant-tabs-content-holder">
                    <div class="ant-tabs-content ant-tabs-content-top ant-tabs-content-animated">
                        <!-- Ticket Info Tab -->
                        <div role="tabpanel" class="ant-tabs-tabpane ant-tabs-tabpane-active" id="ticket-content">
                            <div class="ant-list ant-list-split" style="padding: 0 24px;">
                                <div class="ant-spin-container">
                                    <div class="ant-list-items">
                                        <!-- Carrier Info -->
                                        <div class="ant-list-item list-p">
                                            <div class="ant-list-item-meta">
                                                <div class="ant-list-item-meta-avatar">
                                                    <svg class="svg-inline--fa fa-user-pilot fa-xl" style="display: inline-block; height: 1em; overflow: visible; vertical-align: -0.125em;" aria-hidden="true" focusable="false" data-prefix="far" data-icon="user-pilot" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">
                                                        <path fill="currentColor" d="M319.7 352.5L224 416l-95.7-63.49C57.05 355.2 0 413.4 0 485.3C0 500.1 11.94 512 26.66 512H421.3C436.1 512 448 500.1 448 485.3C448 413.4 390.1 355.2 319.7 352.5zM50.69 464c8.043-31.21 33.37-55.43 65.56-61.89L209.5 464H50.69zM238.5 464l93.28-61.89c32.19 6.461 57.52 30.68 65.56 61.89H238.5zM78.54 102.4v44.04C119.1 164.9 169.4 176 224 176s104.9-11.08 145.5-29.55V102.4l21.96-22.3c4.564-4.635 7.129-10.93 7.129-17.48c0-11.35-7.602-21.24-18.44-23.99l-148.3-37.67c-5.096-1.295-10.43-1.295-15.52 0l-148.3 37.67C57.06 41.39 49.46 51.28 49.46 62.62c0 6.555 2.564 12.85 7.129 17.48L78.54 102.4zM161.7 72.85c3.969-7.875 13.56-11.09 21.47-7.156L224 86.13l40.84-20.44c7.938-3.969 17.5-.7505 21.47 7.156c3.938 7.906 .75 17.5-7.156 21.47l-48 23.1C228.9 119.4 226.4 120 224 120S219.1 119.4 216.8 118.3l-48-23.1C160.9 90.35 157.8 80.75 161.7 72.85zM224 272c-41.23 0-74.9-31.51-79.15-71.64C128.1 197.1 112 192.8 96.45 187.5C96.4 189.1 96 190.5 96 192c0 70.69 57.31 128 127.1 128s127.1-57.31 127.1-128c0-1.525-.358-2.941-.4108-4.453C336 192.8 319.9 197.1 303.2 200.4C298.9 240.5 265.2 272 224 272z"></path>
                                                    </svg>
                                                </div>
                                                <div class="ant-list-item-meta-content">
                                                    <div class="ant-list-item-meta-description">Перевозчик</div>
                                                    <h4 class="ant-list-item-meta-title"><span style="font-size: x-large;" id="carrier">ООО Практик</span></h4>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Bus Info -->
                                        <div class="ant-list-item list-p">
                                            <div class="ant-list-item-meta">
                                                <div class="ant-list-item-meta-avatar">
                                                    <svg class="svg-inline--fa fa-bus fa-xl" style="display: inline-block; height: 1em; overflow: visible; vertical-align: -0.125em;" aria-hidden="true" focusable="false" data-prefix="far" data-icon="bus" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512">
                                                        <path fill="currentColor" d="M144 336C144 318.3 158.3 304 176 304C193.7 304 208 318.3 208 336C208 353.7 193.7 368 176 368C158.3 368 144 353.7 144 336zM368 336C368 318.3 382.3 304 400 304C417.7 304 432 318.3 432 336C432 353.7 417.7 368 400 368C382.3 368 368 353.7 368 336zM74.2 70.03C99.86 38.75 167.8 0 288 0C416.6 0 478 38.63 502.4 70.55C509.9 80.32 512 91.48 512 100.4V128C529.7 128 544 142.3 544 160V224C544 241.7 529.7 256 512 256V376C512 400.1 499.3 422.1 480 435.9V488C512 501.3 469.3 512 456 512C442.7 512 432 501.3 432 488V448H144V488C144 501.3 133.3 512 120 512C106.7 512 96 501.3 96 488V435.9C76.7 422.1 64 400.1 64 376V256C46.33 256 32 241.7 32 224V160C32 142.3 46.33 128 64 128V100.4C64 91.58 66.05 79.97 74.2 70.03zM363.7 96H461.2C445.4 78.89 399.2 48 288 48C185.8 48 133.8 78.27 115.5 96H212.3C217.8 86.44 228.2 80 240 80H336C347.8 80 358.2 86.44 363.7 96zM464 144H312V224H464V144zM112 224H264V144H112V224zM112 272V376C112 389.3 122.7 400 136 400H440C453.3 400 464 389.3 464 376V272H112z"></path>
                                                    </svg>
                                                </div>
                                                <div class="ant-list-item-meta-content">
                                                    <div class="ant-list-item-meta-description" id="route">ЛДК - ТЭЦ-3</div>
                                                    <h4 class="ant-list-item-meta-title"><span style="font-size: x-large;" id="bus">х677са124</span></h4>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Price Info -->
                                        <div class="ant-list-item list-p">
                                            <div class="ant-list-item-meta">
                                                <div class="ant-list-item-meta-avatar">
                                                    <svg class="svg-inline--fa fa-ruble-sign fa-xl" style="display: inline-block; height: 1em; overflow: visible; vertical-align: -0.125em;" aria-hidden="true" focusable="false" data-prefix="far" data-icon="ruble-sign" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512">
                                                        <path fill="currentColor" d="M240 32C319.5 32 384 96.47 384 176C384 255.5 319.5 320 240 320H112V368H296C309.3 368 320 378.7 320 392C320 405.3 309.3 416 296 416H112V456C112 469.3 101.3 480 88 480C74.75 480 64 469.3 64 456V416H24C10.75 416 0 405.3 0 392C0 378.7 10.75 368 24 368H64V320H24C10.75 320 0 309.3 0 296C0 282.7 10.75 272 24 272H64V79.31C64 53.18 85.18 32 111.3 32H240zM336 176C336 122.1 293 80 240 80H112V272H240C293 272 336 229 336 176z"></path>
                                                    </svg>
                                                </div>
                                                <div class="ant-list-item-meta-content">
                                                    <div class="ant-list-item-meta-description">Стоимость</div>
                                                    <h4 class="ant-list-item-meta-title"><span style="font-size: x-large;" id="price">1 шт., Полный, 48.00 ₽</span></h4>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Date Info -->
                                        <div class="ant-list-item">
                                            <div class="ant-list-item-meta">
                                                <div class="ant-list-item-meta-avatar">
                                                    <svg class="svg-inline--fa fa-calendar-day fa-xl" style="display: inline-block; height: 1em; overflow: visible; vertical-align: -0.125em;" aria-hidden="true" focusable="false" data-prefix="far" data-icon="calendar-day" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">
                                                        <path fill="currentColor" d="M208 256C216.8 256 224 263.2 224 272V368C224 376.8 216.8 384 208 384H112C103.2 384 96 376.8 96 368V272C96 263.2 103.2 256 112 256H208zM128 0C141.3 0 152 10.75 152 24V64H296V24C296 10.75 306.7 0 320 0C333.3 0 344 10.75 344 24V64H384C419.3 64 448 92.65 448 128V448C448 483.3 419.3 512 384 512H64C28.65 512 0 483.3 0 448V128C0 92.65 28.65 64 64 64H104V24C104 10.75 114.7 0 128 0zM400 192H48V448C48 456.8 55.16 464 64 464H384C392.8 464 400 456.8 400 448V192z"></path>
                                                    </svg>
                                                </div>
                                                <div class="ant-list-item-meta-content">
                                                    <div class="ant-list-item-meta-description">Дата покупки</div>
                                                    <h4 class="ant-list-item-meta-title"><span style="font-size: x-large;" id="date">16 октября 2025 г.</span></h4>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Time Info -->
                                        <div class="ant-list-item" style="padding-bottom: 2px;">
                                            <div class="ant-list-item-meta">
                                                <div class="ant-list-item-meta-avatar">
                                                    <svg class="svg-inline--fa fa-clock-two fa-xl" style="display: inline-block; height: 1em; overflow: visible; vertical-align: -0.125em;" aria-hidden="true" focusable="false" data-prefix="far" data-icon="clock-two" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                                                        <path fill="currentColor" d="M280 211.2L338.7 172C349.7 164.7 364.6 167.7 371.1 178.7C379.3 189.7 376.3 204.6 365.3 211.1L269.3 275.1C261.9 280.9 252.5 281.3 244.7 277.2C236.9 272.1 231.1 264.9 231.1 255.1V119.1C231.1 106.7 242.7 95.1 255.1 95.1C269.3 95.1 280 106.7 280 119.1L280 211.2zM512 256C512 397.4 397.4 512 256 512C114.6 512 0 397.4 0 256C0 114.6 114.6 0 256 0C397.4 0 512 114.6 512 256zM256 48C141.1 48 48 141.1 48 256C48 370.9 141.1 464 256 464C370.9 464 464 370.9 464 256C464 141.1 370.9 48 256 48z"></path>
                                                    </svg>
                                                </div>
                                                <div class="ant-list-item-meta-content">
                                                    <div class="ant-list-item-meta-description">Время покупки</div>
                                                    <h4 class="ant-list-item-meta-title"><span style="font-size: x-large;" id="time">15:17</span></h4>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Control Tab -->
                        <div role="tabpanel" class="ant-tabs-tabpane" id="control-content" style="display: none;">
                            <div style="text-align: center; padding: 20px;">
                                <div style="margin: 20px auto; padding: 15px; background: white; border-radius: 10px; display: inline-block;">
                                    <div id="qrcode"></div>
                                </div>
                                <div style="font-size: 24px; font-weight: bold; margin-top: 20px; color: #D4D4D4;">
                                    № <span id="control-ticket-number">1 261 842 916</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Close Button -->
    <div style="position: fixed; bottom: calc(var(--sat) / 5); left: 0; z-index: 99999; width: 100%; padding: 10px 20px 30px; background: #1A1A1A; box-sizing: border-box;">
        <button id="close-button" style="padding: 10px 20px; color: #fff; font-size: 17px; font-weight: 500; display: flex; align-items: center; justify-content: center; height: 48px; width: 100%; border-radius: 10px; background: #E21A1A; outline: none; border: none; cursor: pointer; text-transform: uppercase;">
            закрыть
        </button>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script>
        // Tab switching functionality
        const ticketTabBtn = document.getElementById('ticket-tab-btn');
        const controlTabBtn = document.getElementById('control-tab-btn');
        const ticketContent = document.getElementById('ticket-content');
        const controlContent = document.getElementById('control-content');
        const inkBar = document.querySelector('.ant-tabs-ink-bar');

        ticketTabBtn.addEventListener('click', () => {
            ticketTabBtn.parentElement.classList.add('ant-tabs-tab-active');
            controlTabBtn.parentElement.classList.remove('ant-tabs-tab-active');
            ticketContent.style.display = 'block';
            controlContent.style.display = 'none';
            inkBar.style.left = '0px';
            inkBar.style.width = '155px';
        });

        controlTabBtn.addEventListener('click', () => {
            controlTabBtn.parentElement.classList.add('ant-tabs-tab-active');
            ticketTabBtn.parentElement.classList.remove('ant-tabs-tab-active');
            ticketContent.style.display = 'none';
            controlContent.style.display = 'block';
            inkBar.style.left = '155px';
            inkBar.style.width = '120px';

            // Generate QR code
            if (!document.getElementById('qrcode').hasChildNodes()) {
                const ticketNumber = document.getElementById('order-id').textContent.replace(/\s/g, '');
                new QRCode(document.getElementById('qrcode'), {
                    text: ticketNumber,
                    width: 200,
                    height: 200,
                    colorDark: "#000000",
                    colorLight: "#ffffff",
                    correctLevel: QRCode.CorrectLevel.H
                });
            }
        });

        // Timer functionality
        function startTimer(duration, display) {
            let timer = duration, seconds;
            const interval = setInterval(() => {
                seconds = parseInt(timer, 10);
                display.textContent = seconds + " сек.";

                if (--timer < 0) {
                    clearInterval(interval);
                    tg.close();
                }
            }, 1000);
        }

        // Close button
        document.getElementById('close-button').addEventListener('click', () => tg.close());

        // Initialize timer
        document.addEventListener('DOMContentLoaded', () => {
            startTimer(15, document.getElementById('timer'));
        });

        // Data loading from URL parameters
        function getQueryParam(name) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(name);
        }

        const ticketDataEncoded = getQueryParam('data');
        if (ticketDataEncoded) {
            try {
                const ticketDataJson = atob(ticketDataEncoded);
                const ticketData = JSON.parse(ticketDataJson);
                
                const ticketNumberWithoutSpaces = ticketData.number.toString();
                const formattedTicketNumber = ticketNumberWithoutSpaces.replace(/\B(?=(\d{3})+(?!\d))/g, ' ');
                
                document.getElementById('order-id').textContent = formattedTicketNumber;
                document.getElementById('carrier').textContent = ticketData.carrier;
                document.getElementById('route').textContent = ticketData.route_name;
                document.getElementById('bus').textContent = ticketData.bus_number;
                document.getElementById('price').textContent = `${ticketData.quantity} шт., Полный ${ticketData.total_price},00 ₽`;
                document.getElementById('date').textContent = ticketData.purchase_date;
                document.getElementById('time').textContent = ticketData.purchase_time;
                document.getElementById('control-ticket-number').textContent = formattedTicketNumber;
                
            } catch (error) {
                console.error('Ошибка при обработке данных билета:', error);
            }
        }
    </script>
</body>
</html>
